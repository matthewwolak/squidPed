---
title: "Simulating Pedigrees"
author: Joel Pick
output: 
  html_document
---
I think a nice approach for the core simulation is to have parameters that are things that can be estimated from a given pedigree (with columns of id, dam, sire and cohort). The nice things about this is that we can take a given pedigree, extract these parameters, simulate a bunch pedigrees from the parameters and then compare them back other metrics (number of half-sibs, parent-offspring links etc), which will allow us to evaluate the simulations in some way.

## Current Assumptions
- Random mating
- Equal sex ratio
- No selection
- No non-stochastic (e.g. between individual) variation in survival or fecundity
- Constant survival and fecundity (i.e. no age-specific vital rates, no senescence etc)

## Basic parameters
- Number of years
- Starting number of females
	
## Vital rates
I think these are mainly going to affect the number of parent-offspring and sibling relationships

- **Fecundity**: number of offspring per female
- **Juvenile survival**: probability of survival from recording point until recruitment
- **Adult survival**: probability of survival from one breeding season to the next
- **Migration**: number of immigrants each year
- **Constant population size?** Whether a constant number of individuals survive each year or whether population size is allowed to stochastically fluctuate

## Mating system
I think these are mainly going to affect the number of full-sibs versus half-sibs

- **Probability of breeding** (can also be thought of as a detection probability in a year - these are not possible to disentangled from a given pedigree)
- **Between-year polyandry**: Probability of retaining the same 'social male' between years (if alive)
- **Within-year polyandry**: Probability that 'social male' sires offspring, or a random male - essentially probability of EPP within a females offspring
- **Polygyny rate** / male reproductive skew
    - Thinking something like a beta distribution of probabilities that a male sires a brood, then social males are sampled with those probabilities
    - how to extract from pedigree?
        - skew within years in repro success?
    - new beta distribution every year?
    - if same beta value between years, very few individuals will dominate pedigree - induce the appearance of selection when phenotypes are simulated?
    - problem - pedigrees only contain breeding individuals, so we don't detect individuals that never breed. But what we extract from pedigree will be biased in the same way we are simulating pedigrees, so probably doesn't matter.
    - might also conflict with between-year polygyny?
- **Age at first reproduction?** modal age?


